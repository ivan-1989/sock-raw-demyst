Этот патч добавляет еще один вид сокета - IPPROTO_ICMP. Что делает возможным отправлять ICMP_ECHO сообщения и принимать отправленные 
ICMP_ECHOREPLY без каких-либо особых привилегий. Другими словами патч делает возможным реализовать 
/bin/ping без setuid и CAP_NET_RAW. Для того, что-бы не увеличивать площадь атаки на ядро, новая функицональность по умолчанию
выключена, но включена поддерживающими это  Linux дистрибутивами, опционально с ограничением по группе или диапазону групп(cм. ниже).

Создание нового ping сокета
	
    socket(PF_INET, SOCK_DGRAM, PROT_ICMP)

Идентификатор сообщения ( 4-5 байты ICMP  заголовка ) используются как локальные порты. Адреса хранятся в структуре sockaddr_in.
Нет резервирования портов для привелигерованных процессов, порт 0 зарезервирован для API ("пусть ядро выберет сводный номер").
Это не предствление - свободный порт, предоствленный пользователем удаленный порт (т.е connect()) игнорируется.
ICMP заголово данный send() проверяется и проходит обработку. Тип должен быть ICMP_ECHO и код должен быть 0 ( будущие расиширения 
должны ослабить это см. ниже)  ID устанавливает номер (local port) сокета, checksum всегда пересчитывается.

socket(2) ограничено диапазоном групп "/proc/sys/net/ipv4/ping_group_range". По умолчанию "1 0" - означающее , что никто (даже root)
не может создать ping сокет. Настройка "100 100" дала бы права одной группе ( либо сделав  /sbin/ping g+s и завладев этой группой
или дать права группе "netadmins"), "0  4294967295" дала бы права абсолютно всем, "100 4294967295" дала бы права всем кроме демонов.

Существующий код мог бы быть ( вряд ли кому это нужно) легко расширен для обработки ICMP cообщений (Timestamp/Reply, 
Information Request/Reply, Address Mask Request/Reply etc.).

Userspace ping и патч 
http://openwall.info/wiki/people/segoon/ping

Для Openwall GNU/*/Linux это был последний шаг для создания дистрибутива без setuid. Этот патч используется ( для RHEL5/OpenVZ ядер)
в Owl-current  2011/03/12 LiveCD ISOs:
http://mirrors.kernel.org/openwall/Owl/current/iso/

Первоначально эта функциональнасть была написана Павлом Канковским для Linux 2.4.32, но к сожалению она так и не стала публичной.

Все опции утилиты ping (-b, -p, -Q, -R, -s, -t, -T, -M, -I)  были протестированы с этим патчем.


PATCH v3:
	- переключение на flowi4.
	- последние измения для совместимости с raw socket.

PATCH v2:
	- изменено ping_debug() на pr_debug().
	- удалено CONFIG_IP_PING.
	- удалено значение ping_seq_fops.owner ( не исполььзуется procfs ).
    	- переключено на proc_net_fops_create().
    	- переклюено на %pK in seq_printf().

PATCH v1:
	- испрвлена ошибка проверки контрольной суммы.
    	- CAP_NET_RAW больше не может создавать ICMP сокеты.

RFC v2:
	- незначительные изменения
	- представлена возможность ограничения socket(2) группами через sysctl.
